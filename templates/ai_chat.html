<!-- Edited By Song Zichen, Quan Hai Middle School -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能辅助学习系统 - AI对话</title>
    <link rel="stylesheet" href="/static/css/ai_chat.css">
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            },
            startup: {
                ready: () => {
                    MathJax.startup.defaultReady();
                    console.log('MathJax is loaded');
                }
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <div class="chat-container">
        <!-- 左侧边栏 -->
        <aside class="chat-sidebar">
            <div class="sidebar-header">
                <h2>AI智能对话</h2>
                <button class="new-chat-btn" onclick="newChat()">
                    <span>+ 新对话</span>
                </button>
            </div>
            
            <div class="history-section">
                <h3>历史对话</h3>
                <div class="history-list" id="history-list">
                    <div class="history-item active" onclick="loadHistory('new')">
                        <div class="history-title">新对话</div>
                    </div>
                </div>
            </div>
        </aside>
        
        <!-- 右侧主内容 -->
        <div class="chat-content">
            <header class="chat-header">
                <div class="header-left">
                    <button class="back-btn" onclick="window.location.href='/'">
                        <span class="back-icon">←</span>
                    </button>
                    <div class="chat-title">新对话</div>
                </div>
                <div class="header-right">
                    <div class="model-selector">
                        <select id="ai-model" class="model-select">
                            <option value="qwen2.5:0.5b">Qwen2.5 0.5B</option>
                        </select>
                    </div>
                </div>
            </header>
            
            <main class="chat-main">
                <div id="chat-messages" class="chat-messages">
                    <div class="chat-message system-message">
                        <div class="message-content">
                            <p>欢迎使用AI智能对话！</p>
                            <p>您可以问我任何问题，我会尽力回答。</p>
                            <p>支持Markdown格式和数学公式。</p>
                        </div>
                    </div>
                </div>
                
                <div class="chat-input-section">
                    <textarea id="chat-input" placeholder="输入您的问题..." rows="3"></textarea>
                    <div class="input-actions">
                        <div class="input-left">
                            <button class="btn btn-secondary" onclick="clearChat()">清空</button>
                        </div>
                        <div class="input-right">
                            <button class="btn btn-primary" onclick="sendMessage()">发送</button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script src="/static/js/ai_chat.js"></script>
</body>
</html>